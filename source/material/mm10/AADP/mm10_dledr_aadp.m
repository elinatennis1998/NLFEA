% Compute average edge segment length for AADP model (derivative)
function dldr = mm10_dledr_aadp(props, np1, n, tau, rho, alpha, beta, es)

% Set up H matrix
% Hab_ee = eye(12); % Table 2
Hab_es = zeros(12); % Table 2
% [~,Hab_ee] = mm10_aadp_GH(1);
Hab_ee = [[0,0,0,0.0141421356237310,0.117851130197758,0.113137084989848,0.0141421356237310,0.113137084989848,0.117851130197758,0.0282842712474619,0.0565685424949238,0.0565685424949238;0,0,0,0.117851130197758,0.0141421356237309,0.113137084989848,0.0565685424949238,0.0471404520791032,0.0565685424949238,0.113137084989848,0.0141421356237310,0.117851130197758;0,0,0,0.0565685424949238,0.0565685424949238,0.0471404520791032,0.117851130197758,0.113137084989848,0.0141421356237309,0.113137084989848,0.117851130197758,0.0235702260395516;0.0141421356237310,0.117851130197758,0.113137084989848,0,0,0,0.0282842712474619,0.0565685424949238,0.0565685424949238,0.0141421356237310,0.113137084989848,0.117851130197758;0.117851130197758,0.0141421356237309,0.113137084989848,0,0,0,0.113137084989848,0.0141421356237310,0.117851130197758,0.0565685424949238,0.0471404520791032,0.0565685424949238;0.0565685424949238,0.0565685424949238,0.0471404520791032,0,0,0,0.113137084989848,0.117851130197758,0.0235702260395516,0.117851130197758,0.113137084989848,0.0141421356237309;0.0141421356237310,0.113137084989848,0.117851130197758,0.0282842712474619,0.0565685424949238,0.0565685424949238,0,0,0,0.0141421356237310,0.117851130197758,0.113137084989848;0.0565685424949238,0.0471404520791032,0.0565685424949238,0.113137084989848,0.0141421356237310,0.117851130197758,0,0,0,0.117851130197758,0.0141421356237309,0.113137084989848;0.117851130197758,0.113137084989848,0.0141421356237309,0.113137084989848,0.117851130197758,0.0235702260395516,0,0,0,0.0565685424949238,0.0565685424949238,0.0471404520791032;0.0282842712474619,0.0565685424949238,0.0565685424949238,0.0141421356237310,0.113137084989848,0.117851130197758,0.0141421356237310,0.117851130197758,0.113137084989848,0,0,0;0.113137084989848,0.0141421356237310,0.117851130197758,0.0565685424949238,0.0471404520791032,0.0565685424949238,0.117851130197758,0.0141421356237309,0.113137084989848,0,0,0;0.113137084989848,0.117851130197758,0.0235702260395516,0.117851130197758,0.113137084989848,0.0141421356237309,0.0565685424949238,0.0565685424949238,0.0471404520791032,0,0,0]];


if es == 1 % beta is edge
    Hab = Hab_ee(alpha,beta);
else % beta is screw
    Hab = Hab_es(alpha,beta);
end

% Evaluate the equation
dldr = -1/2 / sqrt(Hab_ee(alpha,:)*reshape(rho(1:12),12,1) + ...
                  Hab_es(alpha,:)*reshape(rho(13:24),12,1))^3 ...
                  *Hab; %(A.13)
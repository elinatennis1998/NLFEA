% Compute average edge segment length for AADP model
function lbar_e = mm10_lbare_aadp(props, np1, n, tau, rho, i)

% Set up H matrix
% Hab_ee = eye(12); % Table 2
Hab_es = zeros(12); % Table 2
% [~,Hab_ee] = mm10_aadp_GH(1);
Hab_ee = [[0,0,0,0.0141421356237310,0.117851130197758,0.113137084989848,0.0141421356237310,0.113137084989848,0.117851130197758,0.0282842712474619,0.0565685424949238,0.0565685424949238;0,0,0,0.117851130197758,0.0141421356237309,0.113137084989848,0.0565685424949238,0.0471404520791032,0.0565685424949238,0.113137084989848,0.0141421356237310,0.117851130197758;0,0,0,0.0565685424949238,0.0565685424949238,0.0471404520791032,0.117851130197758,0.113137084989848,0.0141421356237309,0.113137084989848,0.117851130197758,0.0235702260395516;0.0141421356237310,0.117851130197758,0.113137084989848,0,0,0,0.0282842712474619,0.0565685424949238,0.0565685424949238,0.0141421356237310,0.113137084989848,0.117851130197758;0.117851130197758,0.0141421356237309,0.113137084989848,0,0,0,0.113137084989848,0.0141421356237310,0.117851130197758,0.0565685424949238,0.0471404520791032,0.0565685424949238;0.0565685424949238,0.0565685424949238,0.0471404520791032,0,0,0,0.113137084989848,0.117851130197758,0.0235702260395516,0.117851130197758,0.113137084989848,0.0141421356237309;0.0141421356237310,0.113137084989848,0.117851130197758,0.0282842712474619,0.0565685424949238,0.0565685424949238,0,0,0,0.0141421356237310,0.117851130197758,0.113137084989848;0.0565685424949238,0.0471404520791032,0.0565685424949238,0.113137084989848,0.0141421356237310,0.117851130197758,0,0,0,0.117851130197758,0.0141421356237309,0.113137084989848;0.117851130197758,0.113137084989848,0.0141421356237309,0.113137084989848,0.117851130197758,0.0235702260395516,0,0,0,0.0565685424949238,0.0565685424949238,0.0471404520791032;0.0282842712474619,0.0565685424949238,0.0565685424949238,0.0141421356237310,0.113137084989848,0.117851130197758,0.0141421356237310,0.117851130197758,0.113137084989848,0,0,0;0.113137084989848,0.0141421356237310,0.117851130197758,0.0565685424949238,0.0471404520791032,0.0565685424949238,0.117851130197758,0.0141421356237309,0.113137084989848,0,0,0;0.113137084989848,0.117851130197758,0.0235702260395516,0.117851130197758,0.113137084989848,0.0141421356237309,0.0565685424949238,0.0565685424949238,0.0471404520791032,0,0,0]];

% Evaluate the equation
lbar_e = 1 / sqrt(Hab_ee(i,:)*reshape(rho(1:12),12,1) + ...
                  Hab_es(i,:)*reshape(rho(13:24),12,1)); %(A.13)